@model RouterDetector.Models.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
}

@functions {
    string GetSeverityBadgeClass(string severity)
    {
        return severity?.ToLower() switch
        {
            "high" => "bg-danger text-white",
            "medium" => "bg-warning text-dark",
            "low" => "bg-success text-white",
            "critical" => "bg-dark text-white",
            _ => "bg-secondary text-white"
        };
    }
}

<div class="container-fluid">
    <h1 class="mt-4">Security Dashboard</h1>
    <p>Real-time threat monitoring and network analysis.</p>

    <!-- Stats Cards -->
    <div class="row">
        <div class="col-xl-3 col-md-6">
            <div class="card bg-primary text-white mb-4">
                <div class="card-body">
                    <h4>@Model.TotalDetectionLogs</h4>
                    <p>Total Threats Detected</p>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card bg-secondary text-white mb-4">
                <div class="card-body">
                    <h4>@Model.TotalNetworkLogs</h4>
                    <p>Total Packets Logged</p>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card bg-danger text-white mb-4">
                <div class="card-body">
                    <h4>@Model.MalwareDetections.Count</h4>
                    <p>Malware/Virus Events</p>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-md-6">
            <div class="card bg-warning text-dark mb-4">
                <div class="card-body">
                    <h4>@(Model.PhishingDetections.Count + Model.SuspiciousEmailDetections.Count)</h4>
                    <p>Phishing & Suspicious Mails</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Threat Details -->
    <div class="row">
        <!-- Malware Detections -->
        <div class="col-lg-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-bug me-1"></i>
                    Malware, Worms, and Trojans Detected
                </div>
                <div class="card-body">
                    @if (Model.MalwareDetections.Any())
                    {
                        <ul class="list-group">
                            @foreach (var item in Model.MalwareDetections)
                            {
                                <li class="list-group-item"><strong>@item.EventType</strong> from @item.SourceIP <span class="badge @GetSeverityBadgeClass(item.Severty)">@item.Severty</span></li>
                            }
                        </ul>
                    }
                    else
                    {
                        <p class="text-center">No malware detected.</p>
                    }
                </div>
            </div>
        </div>

        <!-- Phishing & Email Detections -->
        <div class="col-lg-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-envelope-open-text me-1"></i>
                    Phishing and Suspicious Email Detections
                </div>
                <div class="card-body">
                    @if (Model.PhishingDetections.Any() || Model.SuspiciousEmailDetections.Any())
                    {
                        <ul class="list-group">
                            @foreach (var item in Model.PhishingDetections)
                            {
                                <li class="list-group-item"><strong>Phishing:</strong> @item.EventType <span class="badge @GetSeverityBadgeClass(item.Severty)">@item.Severty</span></li>
                            }
                            @foreach (var item in Model.SuspiciousEmailDetections)
                            {
                                <li class="list-group-item"><strong>Suspicious Email:</strong> @item.Notes <span class="badge @GetSeverityBadgeClass(item.Severty)">@item.Severty</span></li>
                            }
                        </ul>
                    }
                    else
                    {
                        <p class="text-center">No phishing or suspicious emails detected.</p>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Detections -->
    <div class="card mb-4">
        <div class="card-header">
            <i class="fas fa-history me-1"></i>
            Recent Threat Activity
        </div>
        <div class="card-body">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Timestamp</th>
                        <th>Event Type</th>
                        <th>Source IP</th>
                        <th>Severity</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.RecentDetections)
                    {
                        <tr>
                            <td>@item.Timestamp.ToString("g")</td>
                            <td>@item.EventType</td>
                            <td>@item.SourceIP</td>
                            <td><span class="badge @GetSeverityBadgeClass(item.Severty)">@item.Severty</span></td>
                            <td>@item.Notes</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>